% Copyright (C) 1993, Digital Equipment Corporation
% All rights reserved.
% See the file COPYRIGHT for a full description.
%
% Last modified on Tue Jan 24 08:32:45 PST 1995 by kalsow 
%      modified on Fri Apr 30 11:31:44 PDT 1993 by mjordan

readonly HAS_STACK_WALKER = {
  "ALPHA_OSF"  : TRUE,
  "DS3100"     : TRUE,
  "SOLgnu"     : TRUE,
  "SOLsun"     : TRUE,
}

include_dir ("common")
include_dir (OS_TYPE)

%
% platforms with no user thread implementation?
% no or not entirely, native NT386 isn't here
% platforms that are ok with common:
%  ?signal based thread interruption (non-Darwin)
%  common stack walker (NT386 uses IsBadReadPtr, so not here)
%  other stuff
% If this is related to user threads though, consider restoring
% their support for PPC_LINUX (broken due to common glibc problem) and NetBSD_i386.
% Historically pagesize was here, but with VM-synchronized GC gone, pagesize
% has a reduced meaning and need not be "correct".
%
if equal (TARGET, "SPARC64_OPENBSD") or equal (TARGET, "PPC32_OPENBSD")
    or equal (TARGET, "MIPS64_OPENBSD") or equal (TARGET, "I386_OPENBSD")
    or equal (TARGET, "MIPS32_IRIX") or equal (TARGET, "MIPS64_IRIX")
    or equal (TARGET, "SPARC32_LINUX") or equal (TARGET, "SPARC64_LINUX")
    or equal (TARGET, "PPC_LINUX") or equal (TARGET, "AMD64_LINUX")
    or equal (TARGET, "PA32_HPUX") or equal (TARGET, "PA64_HPUX")
    or equal (TARGET, "AMD64_FREEBSD") or (equal(TARGET, "NT386") and equal(OS_TYPE, "POSIX"))
    or equal (TARGET, "NetBSD2_i386")

  % nothing

else
  include_dir (TARGET)
end

if defined("M3_USE_STACK_WALKER")
  if M3_USE_STACK_WALKER and HAS_STACK_WALKER contains TARGET
    if HAS_STACK_WALKER{TARGET}
      include_dir("ex_stack")
    else
      include_dir("ex_frame")
    end
  else
    include_dir("ex_frame")
  end
else
  include_dir("ex_frame")
end
